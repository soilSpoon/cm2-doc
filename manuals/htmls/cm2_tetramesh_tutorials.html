<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .page {
            page-break-after: always;
            margin-bottom: 50px;
            padding: 20px;
            border: 1px solid #ddd;
        }
        .page-header {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 20px;
        }
        h1, h2, h3, h4, h5, h6 {
            color: #333;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
        }
        table td, table th {
            border: 1px solid #ddd;
            padding: 8px;
        }
        pre, code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
        }
        pre {
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
<!-- Model: document-parse-250618 -->
<div class="page">
<div class="page-header">Page 1</div>
<h1 id='0' style='font-size:20px'>CM2 TetraMesh® Iso/Aniso</h1>
<br><h1 id='1' style='font-size:16px'>Version 5.6</h1>
<p id='2' data-category='paragraph' style='font-size:18px'>tutorials</p>
<p id='3' data-category='paragraph' style='font-size:14px'>Revision February 2025.<br>https://www.computing-objects.com<br>© Computing Objects SARL - 25 rue du Maréchal Foch, 78000 Versailles, France.</p>
</div>
<div class="page">
<div class="page-header">Page 2</div>
<h1 id='4' style='font-size:20px'>Forewords</h1>
<p id='5' data-category='paragraph' style='font-size:16px'>This manual is a tutorial for the solid tetrahedron mesh generators of the CM2 MeshTools® SDK:</p>
<br><p id='6' data-category='list' style='font-size:16px'>• The isotropic mesher CM2 TetraMesh® Iso,<br>• The anisotropic mesher CM2 TetraMesh® Aniso.</p>
<br><p id='7' data-category='paragraph' style='font-size:16px'>These two tools are constrained unstructured meshers: the boundary mesh (i.e. the triangle surface mesh), and<br>the internal hard faces, hard edges and hard points if any, are kept (if possible) unmodified in the final mesh.</p>
<br><p id='8' data-category='paragraph' style='font-size:16px'>Based on a fast and robust hybrid "advancing-front" and Delaunay algorithm, they generate high quality<br>elements with smooth grading size according to the length of the boundary elements, to the user-specified<br>sizes or to the metric map supported by a background mesh.</p>
<br><p id='9' data-category='paragraph' style='font-size:16px'>They can generate very big meshes – several millions of elements – with a limited amount of memory. The<br>speed is near independent of the number of the elements to be generated.</p>
<br><p id='10' data-category='paragraph' style='font-size:16px'>Option switches can be used to adapt the meshers to the various needs of the user concerning mesh<br>refinement and optimization. In this regard, the meshers can also be used as mere optimizers of some already<br>existing tetrahedral meshes.</p>
<br><p id='11' data-category='paragraph' style='font-size:16px'>Many data concerning the mesh are available upon exit: histograms of the shape qualities and the size<br>qualities, matrix of the neighbors, number of sub-domains, meshed volume...</p>
<br><p id='12' data-category='paragraph' style='font-size:16px'>Like many other meshers of the library, CM2 TetraMesh Iso/Aniso are multi-threaded (you can select in the<br>settings the maximum number of threads the generator can use).<br>The generated meshes are reproducible (same mesh with same input data and same mesh with any number of<br>threads).</p>
<p id='13' data-category='paragraph' style='font-size:16px'>Data are exchanged with the CM2 mesh generators through vector and matrix objects (no file). Beginners<br>should start by reading the manual CM2 Math1 - overview to get first views on these mathematical containers.</p>
<br><p id='14' data-category='paragraph' style='font-size:16px'>For a complete description of the data and settings structures used with these meshers please refer to the<br>CM2 TetraMesh Iso/Aniso - reference manual.</p>
<p id='15' data-category='paragraph' style='font-size:16px'>The source code of the CM2 MeshTools® (full library) has been registered with the APP under Inter Deposit<br>number IDDN.FR.001.260002.00.R.P.1998.000.20700 (22/06/1998) and<br>IDDN.FR.001.480030.006.S.P.2001.000.20700 (23/05/2019) is regularly deposited since then.</p>
<br><p id='16' data-category='paragraph' style='font-size:16px'>The source code specific to CM2 TetraMesh® Iso/Aniso, together with this manual, has been registered with the<br>APP under Inter Deposit number IDDN.FR.001.440019.000.R.P.2008.000.20700 (31/10/2008) and is regularly<br>deposited since then.</p>
<table id='17' style='font-size:14px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>2</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 3</div>
<h1 id='18' style='font-size:20px'>Table of contents</h1>
<p id='19' data-category='index' style='font-size:16px'>Forewords .................................................................................................................................................. 2<br>1. Getting started ...................................................................................................................................... 5<br>Some declarations .................................................................................................................................................................... 6<br>Authorization of the library .................................................................................................................................................... 6<br>Boundary mesh ......................................................................................................................................................................... 7<br>Tetrahedral mesh ..................................................................................................................................................................... 7<br>2. Simple cube ......................................................................................................................................... 10<br>Some declarations .................................................................................................................................................................. 11<br>Boundary mesh ....................................................................................................................................................................... 11<br>Tetrahedral mesh ................................................................................................................................................................... 13<br>3. Cube with an internal hard line ........................................................................................................ 15<br>4. Cube with an internal hard node ..................................................................................................... 18<br>5. Internal cavity ..................................................................................................................................... 20<br>6. Quadratic elements & high-order nodes ........................................................................................ 23<br>7. Multiple meshes ................................................................................................................................. 25<br>8. Repairing the boundary mesh .......................................................................................................... 26<br>9. Background mesh .............................................................................................................................. 28<br>10. Anisotropic meshes (CM2 TetraMesh Aniso) ................................................................................ 31<br>Mesh gallery ............................................................................................................................................ 39</p>
<table id='20' style='font-size:14px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>3</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 4</div>
<p id='21' data-category='paragraph' style='font-size:20px'>This manual shows examples of 3-D tetrahedral meshings illustrating along the way some of the major options<br>of the meshers CM2 TetraMesh® Iso/Aniso.</p>
<br><p id='22' data-category='paragraph' style='font-size:20px'>Each example starts with including the file stdafx.h (can be a pre-compiled header) giving access to the<br>classes and the functions of the library (API).</p>
<p id='23' data-category='paragraph' style='font-size:20px'>The general namespace cm2 has nested namespaces such as cm2::vecscal, cm2::vecvec, cm2:<br>:meshtools or cm2::triamesh_iso. The user can add a using namespace cm2 directive in this stdafx.<br>h file. Keeping namespaces in the user’s source code can however be useful to improve the legibility and to<br>avoid name conflicts. In the rest of this document we assume such a using namespace cm2 directive.</p>
<br><p id='24' data-category='paragraph' style='font-size:20px'>File stdafx.h:</p>
<p id='25' data-category='paragraph' style='font-size:14px'>// CM2 MESHTOOLS</p>
<br><table id='26' style='font-size:14px'><thead></thead><tbody><tr><td>#include "meshtools.h" //</td><td>General purpose mesh routines.</td></tr><tr><td>#include "meshtools2d.h" //</td><td>To generate 1D meshes.</td></tr><tr><td>#include "meshtools2d.h" //</td><td>To generate 2D meshes.</td></tr><tr><td>#include "tetramesh_iso.h" //</td><td>CM2 TetraMesh Iso.</td></tr><tr><td>#include "tetramesh_aniso.h" //</td><td>CM2 TetraMesh Aniso (Section 10 only).</td></tr></tbody></table>
<br><p id='27' data-category='paragraph' style='font-size:14px'>using namespace cm2;</p>
<br><p id='28' data-category='paragraph' style='font-size:14px'>// Main cm2 namespace can now be omitted.</p>
<p id='29' data-category='paragraph' style='font-size:20px'>Required libraries1:</p>
<p id='30' data-category='list' style='font-size:20px'>• cm2math1<br>• cm2misc<br>• cm2meshtools<br>• cm2meshtools2d<br>• cm2meshtools2d<br>• cm2meshtools3d<br>• cm2tetramesh_iso<br>• cm2tetramesh_aniso (Section 10 only)</p>
<p id='31' data-category='paragraph' style='font-size:14px'>1 The lib names end with _($platform)_($ver). For instance cm2tetramesh_iso_x64_56.dll.<br>On Windows, file extensions for the libraries are .lib and .dll. On Linux/Unix/macOS platforms, file extensions are usually .a (static<br>archive), .so or .dylib (dynamic lib).</p>
<table id='32' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>4</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 5</div>
<h1 id='33' style='font-size:22px'>1. Getting started</h1>
<br><p id='34' data-category='paragraph' style='font-size:18px'>The simple way to see CM2 TetraMesh Iso in action is to use a pre-existing boundary mesh (triangle mesh). We<br>assume here we have such a boundary mesh of ready on the ASCII file part.dat. The expected format here is<br>quite simple: first the coordinates of the nodes as a 3xNP matrix, then the connectivity of the triangle mesh as a<br>3xNT matrix2. For each matrix the format is:</p>
<p id='35' data-category='paragraph' style='font-size:20px'>n X m [<br>d0,0 d0,1 d0,2 ... d0,m-1<br>d1,0 d1,1 d1,2 ... d1,m-1<br>...<br>dn-1,0 dn-1,1 dn-1,2... dn-1,m-1 ]</p>
<p id='36' data-category='paragraph' style='font-size:18px'>For instance, a mesh with 4 nodes and 2 triangles could write3:</p>
<p id='37' data-category='paragraph' style='font-size:18px'>3 X 4 [<br>0. 1. 1. 0.<br>0. 0. 1. 1.<br>0. 0. 0.5 0. ]</p>
<br><p id='38' data-category='paragraph' style='font-size:18px'>3 X 2 [<br>0 1<br>1 2<br>3 3 ]</p>
<p id='39' data-category='paragraph' style='font-size:18px'>The source code to generate the tetrahedral mesh writes:</p>
<p id='40' data-category='paragraph' style='font-size:14px'>#include "stdafx.h"<br>#include <iostream><br>#include <fstream></p>
<br><p id='41' data-category='paragraph' style='font-size:14px'>// Simple optional display handler.<br>static void display_hdl (void*, unsigned, const char* msg) { std::cout << msg; }</p>
<br><p id='42' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><p id='43' data-category='paragraph' style='font-size:14px'>{</p>
<br><p id='44' data-category='paragraph' style='font-size:14px'>std::ifstream istrm("part.dat");<br>cm2::tetramesh_iso::mesher the_mesher;<br>cm2::tetramesh_iso::mesher::data_type data;</p>
<br><p id='45' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>cm2::tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='46' data-category='paragraph' style='font-size:14px'>// READ THE BOUNDARY TRIANGLE MESH.<br>cm2::matio::read(istrm, data.pos);<br>cm2::matio::read(istrm, data.connectB);</p>
<br><p id='47' data-category='paragraph' style='font-size:14px'>// GENERATE THE 3D MESH.<br>the_mesher.run(data);</p>
<br><p id='48' data-category='paragraph' style='font-size:14px'>// SOME OUTPUT INFO (OPTIONAL).<br>data.print_info(&display_hdl);</p>
<br><p id='49' data-category='paragraph' style='font-size:14px'>// VISUALISATION (OPTIONAL).<br>cm2::meshtools::medit_output("TH.mesh", data.pos, data.connectM, CM2_TETRA4);</p>
<br><p id='50' data-category='paragraph' style='font-size:14px'>return 0;<br>// main</p>
<br><p id='51' data-category='paragraph' style='font-size:14px'>}</p>
<p id='52' data-category='list' style='font-size:14px'>2 Other supported input formats are: STL (ASCII and binary), FEMAP neutral, Nastran and Alias’ Wavefront OBJ.<br>3 The format for each value is free.</p>
<table id='53' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>5</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 6</div>
<figure id='54'><img style='font-size:16px' alt="Figure 1 – A simple mechanical part." data-coord="top-left:(302,105); bottom-right:(941,685)" /></figure>
<p id='55' data-category='paragraph' style='font-size:20px'>Let us explain this program line by line.</p>
<br><h1 id='56' style='font-size:22px'>Some declarations</h1>
<p id='57' data-category='paragraph' style='font-size:20px'>A standard input stream istrm is built with the data file name part.dat. We create then an instance of the<br>tet mesher (the_mesher) and a data structure (data) that will contain among others the coordinates of the<br>nodes (in field data.pos) and the connectivity matrices (initial triangle boundary mesh in data.connectB<br>and final tet mesh in data.connectM).</p>
<p id='58' data-category='paragraph' style='font-size:20px'>Matrix data.pos is a DoubleMat (variable-sized matrix of doubles)4 and matrices data.connectB and<br>data.connectM are UIntMat. For instance connectB(i, j) is the ith local node of the jth element. This<br>integer refers to the column number in matrix data.pos where the coordinates of this node can be found5.</p>
<h1 id='59' style='font-size:22px'>Authorization of the library</h1>
<p id='60' data-category='paragraph' style='font-size:20px'>The tetramesh_iso library is unlocked through a call to cm2::tetramesh_iso::registration. Two<br>strings must be provided for each library: the name of your company or organization that has acquired the<br>license and a secret code6. Note that both strings are case sensitive and the registration call must be made<br>each time the library is loaded into memory and before any run of the mesher.</p>
<p id='61' data-category='paragraph' style='font-size:16px'>cm2::tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<p id='62' data-category='list' style='font-size:14px'>4 See manual CM2 Math1 - overview.<br>5 Recall that array indices are zero based (from 0 to N-1).<br>6 Contact license@computing-objects.com for any licensing inquiry.</p>
<table id='63' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>6</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 7</div>
<h1 id='64' style='font-size:22px'>Boundary mesh</h1>
<p id='65' data-category='paragraph' style='font-size:20px'>The cm2::matio::read can load matrices following the above specified ASCII format from an input stream7.<br>We use it to load the nodes’ coordinates and the triangle connectivity from the same file.</p>
<p id='66' data-category='paragraph' style='font-size:16px'>cm2::matio::read(istrm, data.pos);<br>cm2::matio::read(istrm, data.connectB);</p>
<h1 id='67' style='font-size:22px'>Tetrahedral mesh</h1>
<p id='68' data-category='paragraph' style='font-size:16px'>the_mesher.run(data);</p>
<p id='69' data-category='paragraph' style='font-size:20px'>Upon exit, the matrix data.pos is bigger and contains all the new nodes generated inside the domain by the<br>tetrahedral mesher. These new points are appended to the original matrix. The initial points of the boundary<br>mesh are left untouched in the first columns.</p>
<br><p id='70' data-category='paragraph' style='font-size:20px'>The connectivity of the final mesh is stored in the matrix data.connectM, each column storing the indices of<br>the nodes for an element. connectM(i, j) is the ith local node of the jth element.</p>
<br><h1 id='71' style='font-size:22px'>Output information</h1>
<br><p id='72' data-category='paragraph' style='font-size:20px'>Printed information about the generated mesh and a MEDIT8 output file are obtained with:</p>
<p id='73' data-category='paragraph' style='font-size:16px'>data.print_info(&display_hdl);<br>cm2::meshtools::medit_output("TH.mesh", data.pos, data.connectM, CM2_TETRA4);</p>
<p id='74' data-category='paragraph' style='font-size:20px'>Figure 2 shows the output given by data.print_info(&display_hdl): the generated mesh is made of<br>2428 nodes and 8008 tetrahedrons for an initial boundary mesh of 4174 triangles and 2085 nodes (hard faces<br>and hard nodes). The time spent in each of the three steps of the meshing process is given in seconds9.</p>
<br><p id='75' data-category='paragraph' style='font-size:20px'>The first step is the generation of the front mesh (3D triangularization of the hard nodes and faces). In the<br>second step, new nodes are generated inside the domain to get elements with good shape and size. Finally, the<br>last step concerns geometrical and topological optimizations to improve the quality of the elements.</p>
<br><p id='76' data-category='paragraph' style='font-size:20px'>The formula used to compute the shape quality of a tetrahedron is given by:</p>
<br><table id='77' style='font-size:20px'><thead></thead><tbody><tr><td>V</td><td>V Volume of the tetrahedron.</td></tr><tr><td>Qs 6� 6 Lmax S</td><td>with: Lmax Length of the longest edge of the tetrahedron. S Total area of the four faces of the tetrahedron.</td></tr></tbody></table>
<p id='78' data-category='footnote' style='font-size:14px'>7 This function is a template function and can be used with a wide range of streams and matrix classes. A similar cm2::matio:<br>:transpose_read function exists to read a matrix and transpose it on the fly.<br>8 MEDIT is a free visualization program (link). Other output formats are: Ensight, FEMAP (neutral), Nastran, STL (ASCII or binary),<br>VTK and Wavefront OBJ.<br>9 All runs were done with x64 CM2 libs (VS 2017 MD build) on Windows® 8.1 x64 with Intel® Xeon® E3-1270 V2 3.5 GHz (4 cores with hyper-<br>threading, turbo boost disabled). The typical speed with default settings on such a platform ranges from 8 000 tets / s. (CM2 TetraMesh®<br>Aniso with background mesh) to more than 80 000 tets / s. (CM2 TetraMesh Iso without background mesh). Speed can be increased<br>further by reducing the optimization level (see reference manual). Pure 3-D tetrahedrisation in CONVEX_HULL_MODE is even faster.</p>
<table id='79' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>7</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 8</div>
<p id='80' data-category='paragraph' style='font-size:18px'>This quality measure ranges from zero (for a degenerated tet) to one (for an equilateral tet).</p>
<br><p id='81' data-category='paragraph' style='font-size:18px'>On the above example, the worst shape quality is 0.23 and the average is 0.68 (Figure 2).</p>
<br><p id='82' data-category='paragraph' style='font-size:18px'>Note that the boundary triangles being not equilateral, the tets built upon them cannot be perfect either. There<br>is an upper bound for the quality of these boundary tets. Here the limit is 0.56. That means that the generator<br>cannot produce a mesh with a minimum quality better than 0.56 in this case.</p>
<br><p id='83' data-category='paragraph' style='font-size:18px'>The size quality is also an important parameter to take into account. The size quality of an edge is a measure<br>based upon its actual length and the target size values set on its vertices. A size quality of 1 indicates that the<br>edge has the right length, i.e. optimal length. A too short edge has a size quality less than 1 (but always<br>positive), and a too long edge has a size quality greater than 1. An edge with a quality of 2 is twice as long as it<br>should be.</p>
<p id='84' data-category='paragraph' style='font-size:18px'>The formula used to compute the length quality of an edge AB writes:</p>
<br><p id='85' data-category='equation'>$$Q_{h}^{A B}=L_{A B}\,\frac{\left|\mathrm{h}_{A}\right|}{h_{B}}$$</p>
<br><p id='86' data-category='paragraph' style='font-size:18px'>with:</p>
<br><p id='87' data-category='list' style='font-size:16px'>LAB Actual length of edge AB.<br>hA Target size at node A (expected edge length at A).<br>hB Target size at node B (expected edge length at B).</p>
<p id='88' data-category='paragraph' style='font-size:18px'>Let’s introduce also at this point the h-shock measure of an edge:</p>
<p id='89' data-category='equation'>$$h s^{4B}=\operatorname*{min}\biggl(\frac{h_{A}}{h_{B}},\frac{h_{B}}{h_{A}}\biggr)^{\frac{1}{Q_{b}^{4B}}}-1$$</p>
<p id='90' data-category='paragraph' style='font-size:18px'>These two measure are dimensionless and positive.</p>
<p id='91' data-category='paragraph' style='font-size:18px'>LAB<br>When hA = hB the h-shock is null and the length writes hQ AB � .<br>hA<br>When ABQh 1� edge AB is considered having optimal length with respect to its target mesh sizes hA and hB.</p>
<br><p id='92' data-category='paragraph' style='font-size:18px'>To optimize a mesh we need to improve simultaneously both the shape quality of the elements and the size<br>quality of the edges. On top of these, the h-shock should be kept lower than a maximum threshold to ensure<br>smooth gradations and all the prescribed entities (hard faces, edges and nodes) must be honored. All this<br>makes the job of the optimizer difficult and heuristics must be used.</p>
<br><p id='93' data-category='paragraph' style='font-size:18px'>The mesher computes the histogram of the size qualities (normalized edge lengths) when the flag my_mesher.<br>settings.compute_Qh_flag10 is set to true11.</p>
<br><p id='94' data-category='paragraph' style='font-size:18px'>On this example, the size qualities are well centered near the value 1 (mean value 1.01) with a small variance<br>(Figure 3).</p>
<p id='95' data-category='paragraph' style='font-size:14px'>10 See reference manual for details on the settings of the meshers.</p>
<p id='96' data-category='paragraph' style='font-size:14px'>11 It can also be computed after the meshing with a call to cm2::meshtools::edge_qualities.</p>
<table id='97' style='font-size:14px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>8</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 9</div>
<figure id='98'><img style='font-size:14px' alt="*******************************************************
* CM2 TetraMesh(R) Iso (5.6.0.0) *
*******************************************************
Hard nodes : 2085/2085
Hard edges : 6261/6261
Hard faces : 4174/4174
Nodes : 2428
Tets : 8008
Missing faces : 0
Subdomains : 1
Volume : 1.802054E+04
Qmin : 1.120209E-01 (max-min: 5.561858E-01)
Steiner nodes : 0
Front time : 0.07 s.
Refine time : 0.03 s.
Optim time : 0.02 s.
Total time : 0.12 s. (65105.74 th/s.)
************ HISTOGRAM QS *************
Total number of bins : 11
Total number of counts : 8008
Number of larger values : 0
Number of smaller values : 0
V max : 9.981352E-01
V mean : 6.785422E-01
V min : 1.120209E-01
Bin number -- Bin boundaries -- Hits
10 0.90 1.00 342
9 0.80 0.90 881
8 0.70 0.80 1972
7 0.60 0.70 2536
6 0.50 0.60 1947
5 0.40 0.50 289
4 0.30 0.40 39
3 0.20 0.30 1
2 0.10 0.20 1
1 0.01 0.10 0
0 0.00 0.01 0
NODES : 2428
NEFS : 8008
TIME : 0.12 s.
NEFS / s : 65105.74" data-coord="top-left:(112,122); bottom-right:(1142,843)" /></figure>
<caption id='99' style='font-size:16px'>Figure 2 – Output info for the “mechanical part” example.</caption>
<figure id='100'><img style='font-size:14px' alt="************ HISTOGRAM QH *************
Total number of bins : 20
Total number of counts : 12524
Number of larger values : 0
Number of smaller values : 0
V max : 1.762665E+00
V mean : 1.008241E+00
V min : 2.886290E-01
Bin number -- Bin boundaries -- Hits
19 10.00 +INF 0
18 5.00 10.00 0
17 3.33 5.00 0
16 2.50 3.33 0
15 2.00 2.50 0
14 1.67 2.00 5
13 1.43 1.67 405
12 1.25 1.43 1430
11 1.11 1.25 1331
10 1.00 1.11 2589
9 0.90 1.00 3237
8 0.80 0.90 1629
7 0.70 0.80 1313
6 0.60 0.70 453
5 0.50 0.60 75
4 0.40 0.50 44
3 0.30 0.40 11
2 0.20 0.30 2
1 0.10 0.20 0
0 0.00 0.10 0" data-coord="top-left:(107,948); bottom-right:(1141,1463)" /></figure>
<caption id='101' style='font-size:16px'>Figure 3 – Histogram of the size-qualities of all the edges in the “mechanical part” example.</caption>
<table id='102' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>9</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 10</div>
<h1 id='103' style='font-size:20px'>2. Simple cube</h1>
<br><p id='104' data-category='paragraph' style='font-size:18px'>This second example illustrates some of the meshtools auxiliary functions to generate 1-D and 2-D meshes.<br>This will also help introduce some options of CM2 TetraMesh Iso in following examples.</p>
<br><p id='105' data-category='paragraph' style='font-size:18px'>The following code meshes a cube from scratch (no boundary mesh read from file, cm2 namespace omitted):</p>
<p id='106' data-category='paragraph' style='font-size:14px'>#include "stdafx.h"<br>#include <iostream></p>
<br><p id='107' data-category='paragraph' style='font-size:14px'>// Simple optional display handler.<br>static void display_hdl (void*, unsigned, const char* msg) { std::cout << msg; }</p>
<br><p id='108' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><p id='109' data-category='paragraph' style='font-size:14px'>{</p>
<br><table id='110' style='font-size:14px'><thead></thead><tbody><tr><td>const unsigned</td><td>N(6);</td><td>// The discretization along each edge.</td></tr><tr><td>const double</td><td>L(4.);</td><td>// The sides length.</td></tr><tr><td>DoubleMat</td><td>pos;</td><td></td></tr><tr><td>UIntMat</td><td>connectE,</td><td>connectB, connectB1, connectB2;</td></tr><tr><td>UIntVec</td><td>indices;</td><td></td></tr></tbody></table>
<br><p id='111' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='112' data-category='paragraph' style='font-size:14px'>// BOUNDARY TRIANGLE MESH.<br>meshtools2d::extrude_translate(pos, DoubleVec3(0, 0, L), DoubleVec3(L, 0, 0), N, indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);<br>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(0, L, 0), N, 2, connectB);</p>
<br><p id='113' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(0., M_PI, 0.), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='114' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(M_PI/2, 0., 0.), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='115' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB2, connectB1);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(0., 0., M_PI/2), connectB2);<br>connectB.push_back(connectB2);</p>
<br><p id='116' data-category='paragraph' style='font-size:14px'>meshtools::merge(pos, connectB, /*tol=>*/ 1E-6, /*merge_type=>*/ 0);</p>
<p id='117' data-category='paragraph' style='font-size:14px'>// 3D MESH.<br>tetramesh_iso::mesher the_mesher;<br>tetramesh_iso::mesher::data_type data(pos, connectB);<br>the_mesher.run(data);</p>
<br><p id='118' data-category='paragraph' style='font-size:14px'>// VISUALISATION (OPTIONAL).<br>data.print_info(&display_hdl);<br>meshtools::medit_output("TH.mesh", data.pos, data.connectM, CM2_TETRA4);</p>
<br><p id='119' data-category='paragraph' style='font-size:14px'>return 0;<br>} // main</p>
<table id='120' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>10</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 11</div>
<figure id='121'><img style='font-size:14px' alt="Figure 4 – Simple cube." data-coord="top-left:(335,112); bottom-right:(904,750)" /></figure>
<p id='122' data-category='paragraph' style='font-size:18px'>Let us again explain this program line by line.</p>
<br><p id='123' data-category='paragraph' style='font-size:18px'>Most of the lines are related to the generation of the boundary mesh. The tetrahedral mesh itself uses only<br>three lines in the program.</p>
<h1 id='124' style='font-size:20px'>Some declarations</h1>
<p id='125' data-category='paragraph' style='font-size:18px'>Matrix pos stores all the points’ coordinates: the nodes of the initial (boundary) mesh and the nodes of the<br>final mesh (many of them are in both).</p>
<br><p id='126' data-category='paragraph' style='font-size:18px'>Matrix connectB stores the connectivity matrix of the boundary triangle mesh.</p>
<br><p id='127' data-category='paragraph' style='font-size:18px'>Matrices connectB1, connectB2 and connectE are temporaries as well as vector indices.</p>
<h1 id='128' style='font-size:20px'>Boundary mesh</h1>
<p id='129' data-category='paragraph' style='font-size:18px'>In this example, we only use routines from the CM2 MeshTools® SDK but, as already seen, the user is free to<br>generate this boundary mesh with other tools or even to read it from a file. In any case, the tetrahedral mesher<br>needs this boundary mesh as a couple of matrices: the matrix pos of coordinates of the nodes and the matrix<br>connectB of connectivity of the boundary triangles.</p>
<br><p id='130' data-category='paragraph' style='font-size:18px'>We choose to generate the mesh on one of the faces and then copy and rotate to get the other five faces of<br>the cube.</p>
<br><p id='131' data-category='paragraph' style='font-size:18px'>The first face is done in three steps. First, N+1 points are generated along the line (0, 0, L) - (L, 0, L):</p>
<p id='132' data-category='paragraph' style='font-size:14px'>meshtools2d::extrude_translate(pos, DoubleVec3(0., 0., L), DoubleVec3(L, 0., 0.), N, indices);</p>
<table id='133' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>11</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 12</div>
<p id='134' data-category='paragraph' style='font-size:20px'>This generates N+1 points equally spaced between (0, 0, L) and (L, 0, L) as new appended columns in the pos<br>matrix. The index of each point (i.e. the column in matrix pos) is also appended to the vector indices. This<br>vector contains upon exit of this function (N = 6):</p>
<p id='135' data-category='paragraph' style='font-size:20px'>[0 1 2 3 4 5 6]</p>
<p id='136' data-category='paragraph' style='font-size:20px'>And the matrix pos is now a 3x7 matrix. The first column equals to (0, 0, L) and the last one to (L, 0, L).<br>The vector of indices is used to create the connectivity matrix of the first edge mesh:</p>
<p id='137' data-category='paragraph' style='font-size:16px'>meshtools2d::indices_to_connectE2(indices, connectE);</p>
<p id='138' data-category='paragraph' style='font-size:20px'>connectE is now a 2x6 matrix:</p>
<p id='139' data-category='paragraph' style='font-size:20px'>2x6 [0 1 2 3 4 5<br>1 2 3 4 5 6]</p>
<p id='140' data-category='paragraph' style='font-size:20px'>This line mesh is then extruded into a mesh of triangles along vector (0, L, 0):</p>
<p id='141' data-category='paragraph' style='font-size:16px'>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(0., L, 0.), N, 2, connectB);</p>
<p id='142' data-category='paragraph' style='font-size:20px'>The 5th parameter (here 2) controls the type of triangle mesh to be generated: 2 is for an alternate “Union Jack”<br>pattern, 0 and 1 for a simply oriented mesh (left or right)12. The coordinates of the new points are appended to<br>matrix pos which now becomes a 3 x 49 matrix13 The 72 generated triangles are appended to matrix<br>connectB as new columns of indices of nodes.</p>
<p id='143' data-category='paragraph' style='font-size:20px'>We now have to copy and rotate this mesh:</p>
<p id='144' data-category='paragraph' style='font-size:16px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(0., M_PI, 0.), connectB1);<br>connectB.push_back(connectB1);</p>
<p id='145' data-category='paragraph' style='font-size:20px'>After the copy, the two meshes connectB and connectB1 are coincident (geometrically equal) and matrix<br>pos is twice as bigger as before. The new copy is then subjected to a rotation of π around axis {(L/2, L/2, L/2),<br>Y}. It is then concatenated to the first mesh: the columns of connectB1 are appended to connectB.</p>
<p id='146' data-category='paragraph' style='font-size:14px'>12 Several variants of this function are available in the meshtools2d library and are described in the API.</p>
<p id='147' data-category='footnote' style='font-size:14px'>13 The memory is automatically reallocated as the matrix grows. If size is known early, reserving space can avoid memory reallocations and<br>copies: pos.reserve(3, 500); // reserve space for 500 points but dimensions are unchanged.</p>
<table id='148' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>12</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 13</div>
<p id='149' data-category='paragraph' style='font-size:20px'>The two faces together are then copied and rotated twice in order to generate the other four missing faces of<br>the cube:</p>
<p id='150' data-category='paragraph' style='font-size:16px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(M_PI/2, 0., 0.), connectB1);<br>connectB.push_back(connectB1);<br>meshtools::copy_mesh(pos, connectB2, connectB1);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(0., 0., M_PI/2), connectB2);<br>connectB.push_back(connectB2);</p>
<p id='151' data-category='paragraph' style='font-size:20px'>At this stage, connectB has 432 columns, i.e. 432 triangles and matrix pos has 294 columns, i.e. 294 points.<br>However, some points are coincident and need to be merged together:</p>
<p id='152' data-category='paragraph' style='font-size:16px'>meshtools::merge(pos, connectB, /*tol=>*/ 1E-6, /*merge_type=>*/ 0);</p>
<p id='153' data-category='paragraph' style='font-size:20px'>This function has no effect on matrix pos only on connectB. When at least two nodes are coincident, the<br>index of the first node encountered replaces all the others subsequent coincident nodes14.</p>
<h1 id='154' style='font-size:22px'>Tetrahedral mesh</h1>
<p id='155' data-category='paragraph' style='font-size:20px'>Now we have generated the boundary mesh, we can call the 3-D mesher on it:</p>
<p id='156' data-category='paragraph' style='font-size:16px'>tetramesh_iso::mesher::data_type data(pos, connectB);<br>the_mesher.run(data);</p>
<p id='157' data-category='paragraph' style='font-size:20px'>The difference with the previous example is that matrices pos and connect are built first and then passed to<br>the data structure whereas in Section 1 we loaded directly data.pos and data.connectB from the stream.<br>There is no significant difference between the two approaches. We can either modify directly data.pos and<br>data.connectB or build some separated matrices pos and connect and then pass them to the data<br>constructor. There is no hard copy done here, only shallow copies (data are shared). See manual CM2 Math1 -<br>overview.</p>
<br><p id='158' data-category='paragraph' style='font-size:20px'>Upon exit, the matrix data.pos is bigger15 and contains all the new nodes generated inside the cube by the<br>tetrahedral mesher on top of the initial surface points.</p>
<p id='159' data-category='paragraph' style='font-size:14px'>14 Note that this will leave some unused points in matrix pos. This space can be recovered using cm2::meshtools::simplify.</p>
<p id='160' data-category='paragraph' style='font-size:14px'>15 But the pos matrix still has 294 columns.</p>
<table id='161' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>13</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 14</div>
<figure id='162'><img style='font-size:14px' alt="*******************************************************
* CM2 TetraMesh(R) Iso (5.6.0.0) *
*******************************************************
Hard nodes : 218/218
Hard edges : 648/648
Hard faces : 432/432
Nodes : 277
Tets : 900
Missing faces : 0
Subdomains : 1
Volume : 6.400000E+01
Qmin : 4.930722E-01 (max-min: 7.821716E-01)
Steiner nodes : 0
Front time : 0.01 s.
Refine time : 0.00 s.
Optim time : 0.00 s.
Total time : 0.02 s. (59999.58 th/s.)
************ HISTOGRAM QS ************
Total number of bins : 11
Total number of counts : 900
Number of larger values : 0
Number of smaller values : 0
V max : 1.000000E+00
V mean : 6.972722E-01
V min : 4.930722E-01
Bin number -- Bin boundaries -- Hits
10 0.90 1.00 11
9 0.80 0.90 88
8 0.70 0.80 373
7 0.60 0.70 285
6 0.50 0.60 142
5 0.40 0.50 1
4 0.30 0.40 0
3 0.20 0.30 0
2 0.10 0.20 0
1 0.01 0.10 0
0 0.00 0.01 0
NODES : 277
NEFS : 900
TIME : 0.02 s.
NEFS / s : 59999.58" data-coord="top-left:(112,120); bottom-right:(1142,844)" /></figure>
<br><caption id='163' style='font-size:16px'>Figure 5 – Output info for the cube example.</caption>
<figure id='164'><img style='font-size:14px' alt="************ HISTOGRAM QH ************
Total number of bins : 20
Total number of counts : 1392
Number of larger values : 0
Number of smaller values : 0
V max : 1.480346E+00
V mean : 9.585737E-01
V min : 6.612180E-01
Bin number -- Bin boundaries -- Hits
19 10.00 +INF 0
18 5.00 10.00 0
17 3.33 5.00 0
16 2.50 3.33 0
15 2.00 2.50 0
14 1.67 2.00 0
13 1.43 1.67 2
12 1.25 1.43 126
11 1.11 1.25 162
10 1.00 1.11 469
9 0.90 1.00 109
8 0.80 0.90 52
7 0.70 0.80 467
6 0.60 0.70 5
5 0.50 0.60 0
4 0.40 0.50 0
3 0.30 0.40 0
2 0.20 0.30 0
1 0.10 0.20 0
0 0.00 0.10 0" data-coord="top-left:(106,921); bottom-right:(1143,1439)" /></figure>
<caption id='165' style='font-size:16px'>Figure 6 – Histogram of the size-qualities of all the edges in the cube example.</caption>
<table id='166' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>14</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 15</div>
<h1 id='167' style='font-size:20px'>3. Cube with an internal hard line</h1>
<br><p id='168' data-category='paragraph' style='font-size:18px'>Starting from the previous example, we add a hard line inside the cube:</p>
<p id='169' data-category='paragraph' style='font-size:14px'>#include "stdafx.h"</p>
<br><p id='170' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><p id='171' data-category='paragraph' style='font-size:14px'>{</p>
<br><table id='172' style='font-size:14px'><thead></thead><tbody><tr><td>const unsigned</td><td>N(6); // The discretization along each edge.</td></tr><tr><td>const double</td><td>L(4.); // The sides length.</td></tr><tr><td>DoubleMat</td><td>pos;</td></tr><tr><td>UIntMat</td><td>connectE, connectB, connectB1, connectB2, connectM2;</td></tr><tr><td>UIntVec</td><td>indices;</td></tr></tbody></table>
<br><p id='173' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='174' data-category='paragraph' style='font-size:14px'>// BOUNDARY TRIANGLE MESH.<br>meshtools2d::extrude_translate(pos, DoubleVec3(0,0,L), DoubleVec3(L, 0., 0.), N, indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);<br>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(0., L, 0.), N, 2, connectB);</p>
<br><p id='175' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(0., M_PI, 0.), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='176' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(M_PI/2, 0., 0.), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='177' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB2, connectB1);<br>meshtools::rotate(pos, DoubleVec3(L/2, L/2, L/2), DoubleVec3(0., 0., M_PI/2), connectB2);<br>connectB.push_back(connectB2);</p>
<br><p id='178' data-category='paragraph' style='font-size:14px'>indices.clear(); connectE.clear();<br>meshtools2d::extrude_translate(pos, DoubleVec3(0,L/2,L/2), DoubleVec3(L,0,0), 4*N, indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);<br>meshtools::merge(pos, connectB, connectE, /*tol=>*/ 1E-6);</p>
<br><p id='179' data-category='paragraph' style='font-size:14px'>// 3D MESH.</p>
<br><p id='180' data-category='paragraph' style='font-size:14px'>tetramesh_iso::mesher the_mesher;<br>tetramesh_iso::mesher::data_type data(pos, connectB);<br>data.connectE = connectE;<br>the_mesher.run(data);</p>
<p id='181' data-category='paragraph' style='font-size:14px'>// MESH VISUALIZATION.<br>meshtools::clip(data.pos, data.connectM,<br>DoubleVec3(0., 0., L/2 + 1E-6), DoubleVec3(0., 0., -1.), connectM2);<br>meshtools::medit_output("TH.mesh", data.pos, connectM2, CM2_TETRA4);</p>
<br><p id='182' data-category='paragraph' style='font-size:14px'>return 0;<br>// main</p>
<br><p id='183' data-category='paragraph' style='font-size:14px'>}</p>
<table id='184' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>15</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 16</div>
<figure id='185'><img alt="" data-coord="top-left:(320,114); bottom-right:(916,601)" /></figure>
<br><caption id='186' style='font-size:14px'>Figure 7 – Half cube with internal line (mesh cut).</caption>
<p id='187' data-category='paragraph' style='font-size:20px'>The mesh of the internal line is generated like the mesh of the first edge of the cube:</p>
<p id='188' data-category='paragraph' style='font-size:14px'>meshtools2d::extrude_translate(pos, DoubleVec3(0., L/2, L/2), DoubleVec3(L,0,0), 4*N, indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);</p>
<p id='189' data-category='paragraph' style='font-size:20px'>This mesh line starts at the center of one of the faces of the cube and extends to the opposite face. The mesh<br>is four times finer along this line than on the cube edges, in order to make the line more visible and also to get<br>a graded mesh size.</p>
<br><p id='190' data-category='paragraph' style='font-size:20px'>To avoid coincident nodes, a merging is needed between the two nodes at extremities of the line and the two<br>matching nodes of the boundary mesh. This is possible because there are actually two nodes of the boundary<br>mesh with coordinates (0, L/2, L/2) and (L, L/2, L/2) due to the regular structured meshing of the faces. This is<br>done concurrently with the merging of the nodes of the edges of the cube already discussed in the previous<br>section:</p>
<p id='191' data-category='paragraph' style='font-size:14px'>meshtools::merge(pos, connectB, connectE, /*tol=>*/ 1E-6);</p>
<p id='192' data-category='paragraph' style='font-size:20px'>The new internal prescribed edges are given to the mesher with:</p>
<figure id='193'><img style='font-size:14px' alt="data.connectE = connectE;" data-coord="top-left:(106,1356); bottom-right:(1139,1437)" /></figure>
<table id='194' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>16</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 17</div>
<p id='195' data-category='paragraph' style='font-size:20px'>To visualize the internal line, we ask for a partial copy of the mesh in matrix connectM2 by removing all tets<br>with at least one node with Z coordinate greater than L/2. This has no effect on the coordinate matrix data.<br>pos, or on the connectivity matrix of the full mesh data.connectM:</p>
<p id='196' data-category='paragraph' style='font-size:14px'>meshtools::clip<br>(data.pos, data.connectM,<br>DoubleVec3(0., 0., L/2 + 1E-6), DoubleVec3(0., 0., -1.), connectM2);<br>meshtools::medit_output("TH.mesh", data.pos, connectM2, CM2_TETRA4);</p>
<p id='197' data-category='paragraph' style='font-size:20px'>To constrain an internal surface, almost the same scheme has to be followed: generation of the internal surface<br>mesh, merging with the nodes of the boundary mesh if needed, and insertion of the connectivity of these hard<br>faces into the matrix data.connectB for instance with a push-back (see next example).</p>
<table id='198' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>17</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 18</div>
<h1 id='199' style='font-size:20px'>4. Cube with an internal hard node</h1>
<p id='200' data-category='paragraph' style='font-size:18px'>There are several ways to get graded sizes in a mesh. The simplest way is to generate faces or edges with<br>different or varying size on the boundary and interior surface or line, like in the previous example. The mesher<br>computes a size value on each hard node16, interpolates these values inside the domain and generates<br>elements accordingly.</p>
<br><p id='201' data-category='paragraph' style='font-size:18px'>A second way is to specify manually, in the data of the tetrahedral mesher, the target size values on some or all<br>the hard nodes. This is explained in this section.</p>
<br><p id='202' data-category='paragraph' style='font-size:18px'>So far, we have seen only four fields of the data structure used by the mesher:</p>
<br><p id='203' data-category='list' style='font-size:18px'>• The pos matrix for the coordinates of the points.<br>• The connectB matrix for the connectivity of the hard faces.<br>• The connectE matrix for the connectivity of the hard edges (seen in Example 2).<br>• The connectM matrix for the connectivity of the output 3-D mesh.</p>
<br><p id='204' data-category='paragraph' style='font-size:18px'>In this example, we will add an isolated hard node (embedded) at the center of the cube and specify a target<br>size for the elements near this node. This is done using two new fields: isolated_nodes and metrics:</p>
<p id='205' data-category='paragraph' style='font-size:14px'>#include "stdafx.h"</p>
<br><p id='206' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><p id='207' data-category='paragraph' style='font-size:14px'>{</p>
<br><table id='208' style='font-size:14px'><thead></thead><tbody><tr><td>const unsigned</td><td>N(6);</td></tr><tr><td>const double</td><td>L(4.);</td></tr><tr><td>DoubleMat</td><td>pos(3, 1, L/2.);</td></tr><tr><td>UIntMat</td><td>connectB, connectB1, connectB2, connectE, connectM2;</td></tr><tr><td>UIntVec</td><td>indices;</td></tr></tbody></table>
<br><p id='209' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='210' data-category='paragraph' style='font-size:14px'>// BOUNDARY 2D MESH.<br>meshtools2d::extrude_translate(pos, DoubleVec3(0,0,L), DoubleVec3(L,0,0), N,</p>
<br><p id='211' data-category='paragraph' style='font-size:14px'>indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);<br>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(0,L,0), N, 2,<br>connectB);</p>
<p id='212' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2,L/2,L/2), DoubleVec3(0,M_PI,0), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='213' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools::rotate(pos, DoubleVec3(L/2,L/2,L/2), DoubleVec3(M_PI/2,0,0), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='214' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB2, connectB1);<br>meshtools::rotate(pos, DoubleVec3(L/2,L/2,L/2), DoubleVec3(0,0,M_PI/2), connectB2);<br>connectB.push_back(connectB2);<br>meshtools::merge(pos, connectB, /*tol=>*/ 1E-6, /*merge_type=>*/ 0);</p>
<br><p id='215' data-category='paragraph' style='font-size:14px'>// 3D MESH.</p>
<br><p id='216' data-category='paragraph' style='font-size:14px'>tetramesh_iso::mesher the_mesher;<br>tetramesh_iso::mesher::data_type data(pos, connectB);<br>data.isolated_nodes.push_back(0);<br>data.metrics.resize(1, 0.05*L/N);<br>the_mesher.run(data);</p>
<br><p id='217' data-category='paragraph' style='font-size:14px'>// MESH VISUALISATION.<br>meshtools::clip(data.pos, data.connectM,<br>DoubleVec3(0., 0., L/2+1E-6), DoubleVec3(0., 0., -1.), connectM2);<br>meshtools::medit_output("TH.mesh", data.pos, connectM2, CM2_TETRA4);</p>
<br><p id='218' data-category='paragraph' style='font-size:14px'>return 0;<br>} // main</p>
<p id='219' data-category='paragraph' style='font-size:18px'>Initializing pos as a 3 x 1 matrix with the value L/2 simply creates the central node17. This node is taken into<br>account by the mesher when its index (here zero) is inserted into the vector data.isolated nodes:</p>
<table id='220' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>18</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 19</div>
<h1 id='221' style='font-size:16px'>data.isolated_nodes.push_back(0);</h1>
<p id='222' data-category='paragraph' style='font-size:20px'>The vector data.metrics stores the user-specified elements’ size. If the size value for a node is zero (or<br>negative or not present), the automatically computed value will be used instead18. In this example the vector is<br>resized to 1 to set only a value for the node #0. We ask for a 20 times finer mesh around it:</p>
<p id='223' data-category='paragraph' style='font-size:16px'>data.metrics.resize(1, 0.05*L/N);</p>
<p id='224' data-category='paragraph' style='font-size:20px'>For all the other nodes, we let the mesher compute suitable values.</p>
<figure id='225'><img alt="" data-coord="top-left:(317,543); bottom-right:(920,1095)" /></figure>
<br><caption id='226' style='font-size:16px'>Figure 8 – Half cube with internal hard node (mesh cut).</caption>
<p id='227' data-category='list' style='font-size:14px'>16 By averaging the lengths of the adjacent edges to each hard node and the inscribed radius of the triangles.<br>17 Another way to do this is from an empty pos matrix is: pos.push_back(DoubleVec3(L/2, L/2, L/2));<br>18 For an isolated node, the computed size is based on the values of the nearest nodes.</p>
<table id='228' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>19</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 20</div>
<h1 id='229' style='font-size:22px'>5. Internal cavity</h1>
<br><p id='230' data-category='paragraph' style='font-size:20px'>A cavity is an internal closed surface with triangles oriented the opposite way from the external boundary. This<br>implies that all triangles of the external boundary are similarly oriented19. To illustrate this point, we assume we<br>have the boundary mesh of a sphere ready on a file. The code for this example is similar to that of Example 1.</p>
<p id='231' data-category='paragraph' style='font-size:16px'>#include "stdafx.h"<br>#include <fstream></p>
<br><p id='232' data-category='paragraph' style='font-size:16px'>int main()</p>
<br><p id='233' data-category='paragraph' style='font-size:16px'>{</p>
<br><table id='234' style='font-size:16px'><thead></thead><tbody><tr><td>DoubleMat</td><td>pos;</td></tr><tr><td>UIntMat</td><td>connectB;</td></tr><tr><td>std::ifstream</td><td>istrm("sphere.dat");</td></tr></tbody></table>
<br><p id='235' data-category='paragraph' style='font-size:16px'>// UNLOCK THE DLL.<br>tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='236' data-category='paragraph' style='font-size:16px'>// READ THE BOUNDARY TRIANGLE MESH.<br>matio::read(istrm, pos);<br>matio::read(istrm, connectB);</p>
<br><p id='237' data-category='paragraph' style='font-size:16px'>// 3D MESH.<br>tetramesh_iso::mesher the_mesher;<br>tetramesh_iso::mesher::data_type data(pos, connectB);<br>the_mesher.run(data);</p>
<br><p id='238' data-category='paragraph' style='font-size:16px'>// MESH VISUALISATION.<br>meshtools::medit_output("TH.mesh", data.pos, data.connectM, CM2_TETRA4);</p>
<br><p id='239' data-category='paragraph' style='font-size:16px'>return 0;<br>// main</p>
<br><p id='240' data-category='paragraph' style='font-size:16px'>}</p>
<figure id='241'><img style='font-size:16px' alt="Figure 9 – Full sphere." data-coord="top-left:(348,811); bottom-right:(897,1395)" /></figure>
<p id='242' data-category='paragraph' style='font-size:20px'>The surface of the cavity is generated by shrinking a copy of the external boundary (with ratio ½) and reversing<br>the orientation of the triangles:</p>
<p id='243' data-category='paragraph' style='font-size:14px'>19 Without any cavity, the orientation of the triangles of the external boundary can be arbitrary.</p>
<table id='244' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>20</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 21</div>
<p id='245' data-category='paragraph' style='font-size:14px'>#include "stdafx.h"<br>#include <fstream></p>
<br><p id='246' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><p id='247' data-category='paragraph' style='font-size:14px'>{</p>
<br><table id='248' style='font-size:14px'><thead></thead><tbody><tr><td>DoubleMat</td><td>pos;</td></tr><tr><td>UIntMat</td><td>connectB, connectB2, connectM2;</td></tr><tr><td>std::ifstream</td><td>istrm("sphere.dat");</td></tr></tbody></table>
<br><p id='249' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='250' data-category='paragraph' style='font-size:14px'>// OUTER BOUNDARY TRIANGLE MESH.<br>matio::read(istrm, pos);<br>matio::read(istrm, connectB);</p>
<br><p id='251' data-category='paragraph' style='font-size:14px'>// INNER BOUNDARY.<br>meshtools::copy_mesh(pos, connectB2, connectB);<br>meshtools::zoom(pos, DoubleVec3(0.), 0.5, connectB2);<br>meshtools2d::flip_T3(connectB2); // Reverse the orientation.<br>connectB.push_back(connectB2);</p>
<br><p id='252' data-category='paragraph' style='font-size:14px'>// 3D MESH.<br>tetramesh_iso::mesher the_mesher;<br>tetramesh_iso::mesher::data_type data(pos, connectB);<br>the_mesher.run(data);</p>
<br><p id='253' data-category='paragraph' style='font-size:14px'>// MESH VISUALISATION.<br>meshtools::clip(data.pos, data.connectM, DoubleVec3(0.), DoubleVec3(0., 0., -1.), connectM2);<br>meshtools::medit_output("TH.mesh", data.pos, connectM2, CM2_TETRA4);</p>
<br><p id='254' data-category='paragraph' style='font-size:14px'>return 0;<br>// main</p>
<br><p id='255' data-category='paragraph' style='font-size:14px'>}</p>
<figure id='256'><img alt="" data-coord="top-left:(320,764); bottom-right:(925,1245)" /></figure>
<br><caption id='257' style='font-size:14px'>Figure 10 – Hollow sphere (mesh cut).</caption>
<p id='258' data-category='paragraph' style='font-size:20px'>Note that the matrix connectB contains both the external and the internal faces.<br>Nested shells can be generated simply by changing the orientation of the spheres:</p>
<table id='259' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>21</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 22</div>
<figure id='260'><img alt="" data-coord="top-left:(320,112); bottom-right:(923,585)" /></figure>
<br><caption id='261' style='font-size:14px'>Figure 11 – Nested shells (mesh cut).</caption>
<table id='262' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>22</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 23</div>
<h1 id='263' style='font-size:22px'>6. Quadratic elements & high-order nodes</h1>
<br><p id='264' data-category='paragraph' style='font-size:20px'>Let us derive the Example 5 to generate quadratic TH10 elements. To make things simple, we assume here<br>again that the surface mesh of the sphere (here T6 elements) are ready on a file to be read. These quadratic T6<br>elements can be curved or not.</p>
<figure id='265'><img style='font-size:16px' alt="#include 'stdafx.h'
#include <fstream>
int main()
{
DoubleMat pos;
UIntMat connectB, connectT3;
std::ifstream istrm('sphere_t6.dat');
// UNLOCK THE DLL.
tetramesh_iso::registration('Licensed to SMART Inc.', 'F53EA108BCWX');
// READ THE BOUNDARY TRIANGLE MESH (EXPECTED T6 FACES).
matio::read(istrm, pos);
matio::read(istrm, connectB);
connectT3 = connectB.sub_matrix(0, 0, 3, connectB.cols()); // Linear T3s.
// 3D MESH.
tetramesh_iso::mesher the_mesher;
tetramesh_iso::mesher::data_type data(pos, connectT3);
the_mesher.run(data);
meshtools3d::convert_into_quadratic(data.pos, data.connectM, connectB, UIntMat());
// VISUALISATION.
meshtools::medit_output('TH.mesh', data.pos, data.connectM, CM2_TETRA10);
return 0;
} // main" data-coord="top-left:(102,280); bottom-right:(1143,822)" /></figure>
<p id='266' data-category='paragraph' style='font-size:20px'>The mesh generator accepts only linear faces upon entry and give only linear solid elements upon exit. Hence,<br>we have to feed the mesher with the linear view of the connectB connectivity matrix, called connectT3 in the<br>above example (view to the first 3 rows from index 0, 0)20.</p>
<br><p id='267' data-category='paragraph' style='font-size:20px'>After the solid meshing, to transform the TH4 mesh into a TH10 mesh we could simply call21:</p>
<p id='268' data-category='paragraph' style='font-size:16px'>meshtools3d::convert_into_quadratic(data.pos, data.connectM);</p>
<p id='269' data-category='paragraph' style='font-size:20px'>But in order to reuse the quadratic nodes along the boundaries (and keeping curved faces if any), we use an<br>overload function with additional matrix parameters:</p>
<p id='270' data-category='paragraph' style='font-size:16px'>meshtools3d::convert_into_high_order(data.pos, data.connectM, connectB, UIntMat());</p>
<p id='271' data-category='paragraph' style='font-size:20px'>This forces convert_into_quadratic to use the high-order nodes of connectB wherever faces match<br>(connectB is allowed to contain outer boundary faces but also inner embedded boundary faces or any face of<br>the tetrahedrons in data.connectM).</p>
<p id='272' data-category='footnote' style='font-size:14px'>20 The two matrices share the same data. Only dimensions differ (number of rows and leading dimension).</p>
<p id='273' data-category='footnote' style='font-size:14px'>21 A more general function is available to convert into any type of high-order elements:. cm2::meshtools3d::convert_into_high_<br>order. Refer to the HTML reference manual for detailed information.</p>
<table id='274' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>23</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 24</div>
<p id='275' data-category='paragraph' style='font-size:20px'>The connectivity matrix connectB has 6 rows. The first three rows are the linear view (first three nodes of the<br>linear faces)22.</p>
<p id='276' data-category='paragraph' style='font-size:16px'>Linear nodes</p>
<br><table id='277' style='font-size:18px'><thead></thead><tbody><tr><td>0</td><td>1</td><td>2</td><td>5</td><td>5</td><td>1</td><td>3</td><td>4</td></tr><tr><td>1</td><td>3</td><td>3</td><td>2</td><td>0</td><td>6</td><td>6</td><td>3</td></tr><tr><td>2</td><td>2</td><td>4</td><td>4</td><td>2</td><td>3</td><td>7</td><td>7</td></tr><tr><td>8</td><td>11</td><td>13</td><td>14</td><td>9</td><td>18</td><td>20</td><td>21</td></tr><tr><td>9</td><td>8</td><td>14</td><td>15</td><td>16</td><td>12</td><td>21</td><td>22</td></tr><tr><td>10</td><td>12</td><td>11</td><td>16</td><td>17</td><td>19</td><td>18</td><td>13</td></tr></tbody></table>
<p id='278' data-category='paragraph' style='font-size:16px'>Figure 12 – Example of connectivity matrix for quadratic faces (connectB) and view to linear faces (connectT3).</p>
<footer id='279' style='font-size:20px'>The connectivity matrix data.connectM has 4 rows after the TetraMesh run, 10 rows after convert_into_<br>quadratic. The first four rows are the linear view (first four nodes of the linear tetrahedrons).</footer>
<p id='280' data-category='paragraph' style='font-size:14px'>22 The empty matrix parameter stands for specific high-order edges. Here none of them.</p>
<table id='281' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>24</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 25</div>
<h1 id='282' style='font-size:20px'>7. Multiple meshes</h1>
<p id='283' data-category='paragraph' style='font-size:18px'>As seen before, matrix connectB can contain several internal surfaces. It can also contain several external<br>boundary surfaces. This means that several disconnected domains can be meshed simultaneously. As in the<br>previous example, some care must be taken in the orientation of these surfaces. They must be oriented the<br>same way (for instance all normal outside) and these boundaries must not cross each other.</p>
<figure id='284'><img alt="" data-coord="top-left:(127,326); bottom-right:(1110,710)" /></figure>
<br><caption id='285' style='font-size:14px'>Figure 13 – Multiple disconnected sub-domains.</caption>
<table id='286' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>25</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 26</div>
<h1 id='287' style='font-size:22px'>8. Repairing the boundary mesh</h1>
<br><p id='288' data-category='paragraph' style='font-size:20px'>It is a well-known CAD problem that the boundary meshes may sometimes be not perfectly closed (not<br>watertight). In addition, gaps and overlapping elements can be found in 3-D surface meshes.</p>
<br><p id='289' data-category='paragraph' style='font-size:20px'>CM2 TetraMesh Iso/Aniso have a correction algorithm that can repair some of these pathologies23.</p>
<br><p id='290' data-category='paragraph' style='font-size:20px'>To illustrate this point we take two cylinders that intersect each other. The cylinders are generated by simple<br>extrusion of a circle. They are not closed at their extremities and several triangles intersect each others. Some<br>nodes are also coincident.</p>
<figure id='291'><img style='font-size:16px' alt="Figure 14 – Intersecting meshes." data-coord="top-left:(164,392); bottom-right:(1079,969)" /></figure>
<p id='292' data-category='paragraph' style='font-size:20px'>In strict-constraint mode (see reference manual), the generators would stop with an error. In non-strict mode,<br>they remove the intersecting and overlapping triangles and fill all the gaps.</p>
<p id='293' data-category='paragraph' style='font-size:14px'>23 This algorithm is effective only in MESH_MODE and non-strict constraints mode (see reference manual).</p>
<table id='294' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>26</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 27</div>
<figure id='295'><img alt="" data-coord="top-left:(406,97); bottom-right:(841,678)" /></figure>
<br><p id='296' data-category='paragraph' style='font-size:14px'>Figure 15 – Repaired mesh.</p>
<p id='297' data-category='paragraph' style='font-size:20px'>Note that the repairing algorithm uses only the hard nodes of the initial mesh and usually change the geometry<br>of the surface. A more specific tool, called CM2 Intersect® T3 can fix intersections much more precisely by<br>adding new nodes at intersection points (but doesn’t close open gaps). See CM2 Intersect T3 - tutorials.</p>
<table id='298' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>27</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 28</div>
<h1 id='299' style='font-size:20px'>9. Background mesh</h1>
<p id='300' data-category='paragraph' style='font-size:18px'>Sometimes it is not convenient to specify the target mesh sizes at some hard nodes. This is the case especially<br>when automatic mesh adaptivity is involved. The background mesh option is the solution in this case.</p>
<br><p id='301' data-category='paragraph' style='font-size:18px'>The background mesh is an auxiliary mesh used by the mesher to find the target mesh size at any point inside<br>the domain. It’s represented by the connectivity matrix background_mesh in the data of the mesher.</p>
<br><p id='302' data-category='paragraph' style='font-size:18px'>As always, the indices of the nodes refer to columns in the same pos matrix as all other connectivity matrices<br>or vectors (such as connectM or connectB).</p>
<br><p id='303' data-category='paragraph' style='font-size:18px'>The nodes of the background mesh can be all different from the nodes of connectB or some can be common.<br>They must all have a valid associated size value in the metrics array. The size map (also called metrics map) is<br>interpolated inside the background mesh.</p>
<br><p id='304' data-category='paragraph' style='font-size:18px'>In the following example, a simple regular background mesh is used to support a sinusoidal metrics map<br>varying in the three directions. The domain to be meshed is a simple cube regularly discretized on its<br>boundaries.</p>
<p id='305' data-category='paragraph' style='font-size:18px'>To simplify the program, we use the auxiliary function cube_boundary to generate the boundary mesh of a<br>cube centered at the origin.</p>
<p id='306' data-category='paragraph' style='font-size:14px'>#include "stdafx.h"</p>
<p id='307' data-category='paragraph' style='font-size:14px'>// Auxiliary function to generate the 6 faces of a cube centered at (0,0,0),<br>// with edge length equal to "L" and with "N" elements along each edge.<br>void<br>cube_boundary (double L, unsigned N, DoubleMat& pos, UIntMat& connectB)</p>
<br><p id='308' data-category='paragraph' style='font-size:14px'>{</p>
<br><p id='309' data-category='paragraph' style='font-size:14px'>UIntVec indices;<br>UIntMat connectE, connectB1, connectB2;</p>
<br><p id='310' data-category='paragraph' style='font-size:14px'>meshtools2d::extrude_translate(pos, DoubleVec3(-L/2, -L/2, +L/2),<br>DoubleVec3(L, 0., 0.), N, indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);<br>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(0., L, 0.), N, 2, connectB2);</p>
<br><p id='311' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB2);<br>meshtools::rotate(pos, DoubleVec3(0.), DoubleVec3(0., M_PI, 0.), connectB1);<br>connectB2.push_back(connectB1);</p>
<br><p id='312' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB2);<br>meshtools::rotate(pos, DoubleVec3(0.), DoubleVec3(M_PI/2, 0., 0.), connectB1);<br>connectB2.push_back(connectB1);</p>
<br><p id='313' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB1);<br>meshtools::rotate(pos, DoubleVec3(0.), DoubleVec3(0., 0., M_PI/2), connectB1);<br>connectB2.push_back(connectB1);</p>
<br><p id='314' data-category='paragraph' style='font-size:14px'>meshtools::merge(pos, connectB2, /*tol=>*/ 1E-6, /*merge_type=>*/ 0);<br>connectB.push_back(connectB2);</p>
<br><p id='315' data-category='paragraph' style='font-size:14px'>}</p>
<p id='316' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><p id='317' data-category='paragraph' style='font-size:14px'>{</p>
<br><table id='318' style='font-size:14px'><thead></thead><tbody><tr><td>const double</td><td>L(4.), h0(0.5), h1(0.1);</td></tr><tr><td>DoubleMat</td><td>pos;</td></tr><tr><td>UIntVec</td><td>indices;</td></tr><tr><td>UIntMat</td><td>connectB1, connectB2, BGM, connectM2;</td></tr><tr><td>DoubleVec</td><td>sizes;</td></tr><tr><td>unsigned</td><td>N, N_BGM, n;</td></tr><tr><td>double</td><td>w, h;</td></tr><tr><td>tetramesh_iso::mesher</td><td>the_mesher;</td></tr><tr><td>tetramesh_iso::mesher::data_type</td><td>dataTH;</td></tr></tbody></table>
<br><p id='319' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>tetramesh_iso::registration("Licensed to SMART Inc.", "F53EA108BCWX");</p>
<br><p id='320' data-category='paragraph' style='font-size:14px'>// THE BOUNDARY OF THE BACKGROUND MESH<br>N_BGM = unsigned(std::max(L/h0, L/h1));</p>
<table id='321' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>28</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 29</div>
<h1 id='322' style='font-size:14px'>cube_boundary(L, N_BGM, pos, connectB1);</h1>
<br><p id='323' data-category='paragraph' style='font-size:14px'>// THE 3D BACKGROUND MESH.<br>dataTH.pos = pos;<br>dataTH.connectB = connectB1;<br>the_mesher.run(dataTH);<br>dataTH.extract(pos, BGM);</p>
<br><p id='324' data-category='paragraph' style='font-size:14px'>// THE METRICS ON THE 3D BACKGROUND MESH.<br>meshtools::unique_indices(indices, BGM);<br>sizes.resize (pos.cols(), 0.);<br>for (size_t i = 0; i < indices.size(); ++i)</p>
<br><p id='325' data-category='paragraph' style='font-size:14px'>{</p>
<br><p id='326' data-category='paragraph' style='font-size:14px'>n = indices[i];<br>w = vecscal::max_norm(pos.col(n));<br>h = ::cos(8.*M_PI* w/L) * (h0-h1)/2. + (h0+h1)/2.;<br>sizes[n] = h;</p>
<br><p id='327' data-category='paragraph' style='font-size:14px'>}</p>
<br><p id='328' data-category='paragraph' style='font-size:14px'>// THE BOUNDARY OF THE FINAL MESH.<br>cube_boundary(L, N, pos, connectB2);</p>
<br><p id='329' data-category='paragraph' style='font-size:14px'>// THE 3D MESH.<br>dataTH.pos = pos;<br>dataTH.connectB = connectB2;<br>dataTH.background_mesh = BGM;<br>dataTH.metrics = sizes;<br>the_mesher.run(dataTH);</p>
<br><p id='330' data-category='paragraph' style='font-size:14px'>// MESH VISUALISATION.</p>
<br><p id='331' data-category='paragraph' style='font-size:14px'>meshtools::clip(dataTH.pos, dataTH.connectM,<br>DoubleVec3(0., 0., -1E-6), DoubleVec3(0., 0., -1.), connectM2);<br>meshtools::medit_output("TH.mesh", data.pos, connectM2, CM2_TETRA4);</p>
<br><p id='332' data-category='paragraph' style='font-size:14px'>return 0;<br>// main</p>
<br><p id='333' data-category='paragraph' style='font-size:14px'>}</p>
<figure id='334'><img alt="" data-coord="top-left:(318,821); bottom-right:(919,1385)" /></figure>
<caption id='335' style='font-size:14px'>Figure 16 – Use of a background mesh to support a metric map on the domain (mesh cut).</caption>
<p id='336' data-category='paragraph' style='font-size:20px'>The background mesh does not need to fit exactly the domain to be meshed. It can cover only a part of it or be<br>partially outside of the domain. In the zones not covered by the background mesh, the default interpolation of<br>the sizes from the hard nodes is used instead.</p>
<table id='337' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>29</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 30</div>
<p id='338' data-category='paragraph' style='font-size:20px'>Here is an example where the domain and the background mesh are both spheres but the latter is half the<br>radius of the former. We have set a uniform value for the metric map on the background mesh to get a finer<br>mesh in this part. Hence, the metric drops abruptly at the limit of the background mesh, but the mesh is still<br>conformal.</p>
<figure id='339'><img alt="" data-coord="top-left:(320,246); bottom-right:(924,703)" /></figure>
<caption id='340' style='font-size:16px'>Figure 17 – Background mesh covering only a fraction of the domain (mesh cut).</caption>
<p id='341' data-category='paragraph' style='font-size:20px'>The background mesh is a very useful feature to control precisely the size of the elements all over the domain.<br>It can however be time consuming. The finer the background mesh, the longer the meshing process. The<br>background mesh should be coarse wherever the metric is slowly varying and fine only in the regions where<br>the metric is sharply varying and should be approximated with accuracy.</p>
<br><p id='342' data-category='paragraph' style='font-size:20px'>We can also consider the case where the boundary surface mesh of the domain must also be governed by<br>background mesh. Two steps with two different background meshes are required24. First, the surface mesh is<br>generated with the help of a surface background mesh. An anisotropic mesher supporting the background<br>mesh option such as CM2 TriaMesh® Aniso can be used for this purpose (refer to the manual CM2 TriaMesh -<br>CM2 QuadMesh Iso/Aniso - tutorials). After the surface mesh, we can proceed as the previous example to<br>generate a 3-D background mesh supporting the metric map and run the tetrahedral mesher to get the final<br>adapted 3-D mesh.</p>
<p id='343' data-category='paragraph' style='font-size:20px'>☞ A background mesh can be used also in REGULARIZE_MODE on a pre-existing mesh to adapt/optimize it to a<br>changed metrics map (saving a new meshing from scratch).</p>
<p id='344' data-category='paragraph' style='font-size:14px'>24 A third kind of background mesh can be needed to generate the line meshes.</p>
<table id='345' style='font-size:18px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>30</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 31</div>
<h1 id='346' style='font-size:22px'>10. Anisotropic meshes (CM2 TetraMesh Aniso)</h1>
<br><p id='347' data-category='paragraph' style='font-size:18px'>CM2 TetraMesh Iso is an isotropic unstructured mesh generator: it tends to produce equilateral tetrahedrons.<br>It’s sometimes useful however to have elements stretched in some special directions. To deal with complex<br>domains, we still need an unstructured mesher. Here comes the anisotropic unstructured mesh generator<br>CM2 TetraMesh Aniso.<br>CM2 TetraMesh Aniso is almost identical to the isotropic version except for the data.metrics array. This<br>array is now a matrix (instead of a vector). In the isotropic case, we need only a scalar at each node to define<br>the size. Now, the size is defined by a 3 x 3 symmetric matrix at each node (6 doubles), stored column-wise in<br>the metrics array.</p>
<figure id='348'><img style='font-size:18px' alt="h
P" data-coord="top-left:(227,448); bottom-right:(408,623)" /></figure>
<figure id='349'><img alt="" data-coord="top-left:(263,713); bottom-right:(371,819)" /></figure>
<p id='350' data-category='paragraph' style='font-size:14px'>Isotropic tet<br>(size 1 in the isotropic metric h)</p>
<br><figure id='351'><img style='font-size:18px' alt="h2
h0
P
h1" data-coord="top-left:(657,435); bottom-right:(947,829)" /></figure>
<p id='352' data-category='paragraph' style='font-size:14px'>Anisotropic tet<br>(size 1 in the anisotropic metric M)</p>
<p id='353' data-category='paragraph' style='font-size:14px'>Figure 18 – A single scalar defines an isotropic metric (left).<br>A 3-D anisotropic metric needs three vectors (right).</p>
<p id='354' data-category='paragraph' style='font-size:18px'>3-D anisotropic metrics are defined as below:</p>
<br><figure id='355' data-category='chart'><img data-coord="top-left:(136,1071); bottom-right:(906,1533)" /><figcaption><p>Chart Type: line</p></figcaption><table><thead><tr><td></td><td>a</td><td>b</td><td>c</td><td>d</td></tr></thead><tbody><tr><td>item_01</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table></figure>
<br><caption id='356' style='font-size:14px'>Figure 19 – Definition and storage of the 3-D anisotropic metrics.</caption>
<table id='357' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>31</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 32</div>
<p id='358' data-category='paragraph' style='font-size:18px'>Let (v0, v1, v2) be the three orthonormal vectors along the axes of the ellipsoid:</p>
<p id='359' data-category='equation'>$$\begin{array}{l}{{\mathbf{v}_{0}\lVert=\lVert\mathbf{v}_{1}\rVert=\lVert\mathbf{v}_{2}\rVert=1}}\\ {{\mathbf{v}_{0},\mathbf{v}_{1}\rbrack=0}}\\ {{\mathbf{v}_{0},\mathbf{v}_{2}\rbrack=0}}\\ {{\mathbf{v}_{0},\mathbf{v}_{1}\rbrack=0}}\\ {{\mathbf{v}_{0}\times\mathbf{v}_{1},\mathbf{v}_{2}\rfloor=1}}\end{array}$$</p>
<p id='360' data-category='paragraph' style='font-size:20px'>Then, the metric Mj writes:</p>
<br><p id='361' data-category='equation'>$$\begin{array}{c c c}{{}}&{{}}&{{\left[\frac{1}{h_{0}^{~2}}~}&{{}}&{{}}&{{0}}\\ {{}}&{{}}&{{}}\\ {{0~~~~~{\frac{1}{h_{1}^{~2}}}}}&{{}}\\ {{}}&{{}}&{{}}&{{}}\\ {{}}&{{}}&{{}}&{{\displaystyle{\frac{1}{h_{2}^{~2}}}\right]}}\end{array}$$</p>
<br><p id='362' data-category='paragraph' style='font-size:16px'>T B</p>
<br><h1 id='363' style='font-size:20px'>B � �v 0 v1 v 2 �</h1>
<br><p id='364' data-category='paragraph' style='font-size:18px'>with:</p>
<br><h1 id='365' style='font-size:20px'>stored column � wise</h1>
<p id='366' data-category='paragraph' style='font-size:18px'>The h0 , h1 and h2 values are the target sizes of the tets in the three principal directions near point Pj. They are<br>the inverse of the square root of the eigen values of metric Mj.</p>
<br><p id='367' data-category='paragraph' style='font-size:18px'>The 3-D metric equivalent of an isotropic size of h writes:</p>
<p id='368' data-category='equation'>$$M_{j}=\left[\begin{array}{c c c}{{1}}&{{0}}&{{0}}\\ {{h^{2}}}&{{0}}&{{0}}\\ {{0}}&{{0}}&{{0}}\\ {{0}}&{{0}}&{{\frac{1}{h^{2}}}}\end{array}\right]$$</p>
<p id='369' data-category='paragraph' style='font-size:18px'>A null matrix would lead to infinite sizes in the three directions (infinite sphere).</p>
<br><p id='370' data-category='paragraph' style='font-size:18px'>When the user doesn’t specify any metric, the mesher uses the default one which is equivalent to the isotropic<br>case we have seen before. For each hard node, the default metric is based on the length of the adjacent edges.<br>This leads to the same default behavior as their related isotropic counterparts. Take the previous examples and<br>replace:</p>
<p id='371' data-category='paragraph' style='font-size:14px'>tetramesh_iso::mesher the_mesher;</p>
<p id='372' data-category='paragraph' style='font-size:18px'>with</p>
<p id='373' data-category='paragraph' style='font-size:14px'>tetramesh_aniso::mesher the_mesher;</p>
<p id='374' data-category='paragraph' style='font-size:18px'>and you get the same output meshes25.</p>
<br><p id='375' data-category='paragraph' style='font-size:14px'>25 The anisotropic mesher is much slower than its isotropic counterpart though (about 6 times slower).</p>
<table id='376' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>32</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 33</div>
<p id='377' data-category='paragraph' style='font-size:16px'>The following example shows a long "beam" as a parallelepiped of size 10x10x100 discretized with 10 elements<br>along each direction. To get stretched tets in the direction of the beam, we need also to specify an anisotropic<br>metric. Here, the metric is uniform on all the beam and equals simply:</p>
<p id='378' data-category='equation'>$$M_{j}=\left[\begin{array}{c c c}{{{\displaystyle{\left[\frac{1}{h_{0}^{2}}}}}}&{{0}}&{{0}}\\ {{0}}&{{\displaystyle{{\frac{1}{h_{0}^{2}}}}}}&{{0}}\\ {{0}}&{{0}}&{{\displaystyle{{\bar{h}_{1}^{2}}}}}\end{array}\right]$$</p>
<br><p id='379' data-category='paragraph' style='font-size:16px'>with:</p>
<br><h1 id='380' style='font-size:18px'>h0� �</h1>
<br><p id='381' data-category='paragraph' style='font-size:20px'>L0</p>
<br><p id='382' data-category='paragraph' style='font-size:14px'>N 0</p>
<br><h1 id='383' style='font-size:18px'>h1� �</h1>
<br><p id='384' data-category='paragraph' style='font-size:20px'>L1</p>
<br><p id='385' data-category='paragraph' style='font-size:14px'>N 1</p>
<p id='386' data-category='paragraph' style='font-size:16px'>Here, the directions of anisotropy are identical to the global axes X, Y, Z.</p>
<table id='387' style='font-size:14px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>33</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 34</div>
<h1 id='388' style='font-size:14px'>#include "stdafx.h"</h1>
<p id='389' data-category='paragraph' style='font-size:14px'>int main()</p>
<br><h1 id='390' style='font-size:20px'>{{</h1>
<br><table id='391' style='font-size:14px'><thead></thead><tbody><tr><td>const double</td><td>L0(10.), L1(100.);</td></tr><tr><td>const unsigned</td><td>N0(10), N1(10);</td></tr><tr><td>DoubleMat</td><td>pos;</td></tr><tr><td>UIntVec</td><td>indices;</td></tr><tr><td>UIntMat</td><td>connectE, connectB1, connectB2, connectB;</td></tr><tr><td>UIntMat</td><td>connectM, connectM2;</td></tr><tr><td>DoubleMat</td><td>metrics;</td></tr><tr><td>double</td><td>D0, D1;</td></tr></tbody></table>
<br><p id='392' data-category='paragraph' style='font-size:14px'>// UNLOCK THE DLL.<br>tetramesh_aniso::registration("Licensed to SMART Inc.","F53EA108BCWX");</p>
<br><p id='393' data-category='paragraph' style='font-size:14px'>// BOUNDARY 2D MESH.</p>
<br><p id='394' data-category='paragraph' style='font-size:14px'>meshtools2d::extrude_translate(pos, DoubleVec3(0.),<br>DoubleVec3(0., L0, 0.), N0, indices);<br>meshtools2d::indices_to_connectE2(indices, connectE);<br>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(L0, 0., 0.),<br>N0, 2, connectB);</p>
<p id='395' data-category='paragraph' style='font-size:14px'>meshtools::copy_mesh(pos, connectB1, connectB);<br>meshtools2d::flip_T3(connectB1);<br>meshtools::translate(pos, DoubleVec3(0., 0., L1), connectB1);<br>connectB.push_back(connectB1);</p>
<br><p id='396' data-category='paragraph' style='font-size:14px'>connectB1.clear();<br>meshtools2d::extrude_translate_T3(pos, connectE, DoubleVec3(0., 0., L1),</p>
<br><p id='397' data-category='paragraph' style='font-size:14px'>N1, 2, connectB1);<br>meshtools::copy_mesh(pos, connectB2, connectB1);<br>meshtools::rotate(pos, DoubleVec3(L0/2, L0/2, L1/2),<br>DoubleVec3(0,0,M_PI/2), connectB2);<br>connectB1.push_back(connectB2);<br>meshtools::copy_mesh(pos, connectB2, connectB1);<br>meshtools::rotate(pos, DoubleVec3(L0/2, L0/2, L1/2),<br>DoubleVec3(0., 0., M_PI), connectB2);<br>connectB1.push_back(connectB2);<br>connectB.push_back(connectB1);</p>
<br><p id='398' data-category='paragraph' style='font-size:14px'>meshtools::merge(pos, connectB, /*tol=>*/ 1E-6, /*merge_type=>*/ 0);</p>
<br><p id='399' data-category='paragraph' style='font-size:14px'>// METRICS.<br>metrics.resize(6, pos.cols(), 0.);</p>
<br><p id='400' data-category='paragraph' style='font-size:14px'>D0 = 1. / ((L0 / N0) * (L0 / N0));<br>D1 = 1. / ((L1 / N1) * (L1 / N1));</p>
<br><p id='401' data-category='paragraph' style='font-size:14px'>for (size_t n = 0; n < pos.cols(); ++n)</p>
<br><p id='402' data-category='paragraph' style='font-size:14px'>{</p>
<br><table id='403' style='font-size:14px'><thead></thead><tbody><tr><td>metrics(0,n) = D0;</td><td>//</td><td>Mxx</td></tr><tr><td>metrics(1,n) = 0.0;</td><td>//</td><td>Mxy</td></tr><tr><td>metrics(2,n) = D0;</td><td>//</td><td>Myy = Mxx</td></tr><tr><td>metrics(3,n) = 0.0;</td><td>//</td><td>Mxz</td></tr><tr><td>metrics(4,n) = 0.0;</td><td>//</td><td>Myz</td></tr><tr><td>metrics(5,n) = D1;</td><td>//</td><td>Mzz</td></tr></tbody></table>
<br><p id='404' data-category='paragraph' style='font-size:14px'>}</p>
<p id='405' data-category='paragraph' style='font-size:14px'>// 3D MESH.<br>tetramesh_aniso::mesher the_mesher;<br>tetramesh_aniso::mesher::data_type data(pos, connectB);<br>the_mesher.settings.compute_Qh_flag = true;<br>data.metrics = metrics;<br>the_mesher.run(data);<br>data.extract(pos, connectM);<br>data.print_info(&display_hdl);</p>
<p id='406' data-category='paragraph' style='font-size:14px'>// MESH VISUALISATION.<br>meshtools::clip(pos, connectM, DoubleVec3(L0/2 +1E-6, L0/2 +1E-6, 0.),<br>DoubleVec3(-1., 0., 0.), connectM2); // clip out X > 0<br>meshtools::medit_output("TH.mesh", pos, connectM2, CM2_TETRA4);</p>
<br><p id='407' data-category='paragraph' style='font-size:14px'>return 0;<br>// main</p>
<br><p id='408' data-category='paragraph' style='font-size:14px'>}</p>
<table id='409' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>34</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 35</div>
<figure id='410'><img alt="" data-coord="top-left:(294,164); bottom-right:(944,1256)" /></figure>
<p id='411' data-category='paragraph' style='font-size:14px'>Figure 20 – An anisotropic beam. Complete model (up) and mesh cut (bottom).</p>
<p id='412' data-category='paragraph' style='font-size:20px'>Here is the output given by data.print_info. Note that the qualities (shape and edge) are computed using<br>the local anisotropic metrics.</p>
<table id='413' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>35</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 36</div>
<figure id='414'><img style='font-size:14px' alt="*******************************************************
* CM2 TetraMesh Aniso(R) (5.6.0.0) *
*******************************************************
Hard nodes : 602/602
Hard edges : 1800/1800
Hard faces : 1200/1200
Nodes : 1729
Tets : 8360
Missing faces : 0
Subdomains : 1
Volume : 1.000000E+04
Qmin : 4.381141E-01 (max-min: 7.821716E-01)
Steiner nodes : 0
Front time : 0.02 s.
Refine time : 0.12 s.
Optim time : 0.06 s.
Total time : 0.20 s. (42222.23 th/s.)
************ HISTOGRAM QS *************
Total number of bins : 11
Total number of counts : 8360
Number of larger values : 0
Number of smaller values : 0
V max : 9.796000E-01
V mean : 7.451805E-01
V min : 4.381141E-01
Bin number -- Bin boundaries -- Hits
10 0.90 1.00 302
9 0.80 0.90 2168
8 0.70 0.80 3138
7 0.60 0.70 2417
6 0.50 0.60 334
5 0.40 0.50 1
4 0.30 0.40 0
3 0.20 0.30 0
2 0.10 0.20 0
1 0.01 0.10 0
0 0.00 0.01 0
NODES : 1729
NEFS : 8360
TIME : 0.20 s.
NEFS / s : 42222.23" data-coord="top-left:(113,123); bottom-right:(1141,839)" /></figure>
<caption id='415' style='font-size:16px'>Figure 21 – Output info. Shape qualities are computed in the anisotropic metrics.</caption>
<figure id='416'><img style='font-size:14px' alt="************ HISTOGRAM QH *************
Total number of bins : 20
Total number of counts : 10688
Number of larger values : 0
Number of smaller values : 0
V max : 1.589670E+00
V mean : 1.073384E+00
V min : 5.940392E-01
Bin number -- Bin boundaries -- Hits
19 10.00 +INF 0
18 5.00 10.00 0
17 3.33 5.00 0
16 2.50 3.33 0
15 2.00 2.50 0
14 1.67 2.00 0
13 1.43 1.67 83
12 1.25 1.43 1689
11 1.11 1.25 1979
10 1.00 1.11 2737
9 0.90 1.00 2741
8 0.80 0.90 1034
7 0.70 0.80 396
6 0.60 0.70 28
5 0.50 0.60 1
4 0.40 0.50 0
3 0.30 0.40 0
2 0.20 0.30 0
1 0.10 0.20 0
0 0.00 0.10 0" data-coord="top-left:(107,947); bottom-right:(1142,1462)" /></figure>
<caption id='417' style='font-size:16px'>Figure 22 – Edge quality histogram in the anisotropic metrics.</caption>
<table id='418' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>36</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 37</div>
<p id='419' data-category='paragraph' style='font-size:16px'>In the next example the metric is not uniform. A sphere (radius R) is uniformly meshed on its boundary. We<br>used the following metric map:</p>
<br><figure id='420'><img style='font-size:22px' alt="� 1 �
0 0 ������� B�r��T
h 2
0
1
M�r���� B�� � ������� 0 0
r
h�r��2
1
0 0
h�r��2 �
�" data-coord="top-left:(155,180); bottom-right:(561,398)" /></figure>
<br><p id='421' data-category='equation'>$$\mathrm{\bf{B}}{\bf{\tilde{(}}}(r)\!\!\mathrm{\bf{\tilde{|}}_{r}}{\bf{\tilde{|}}_{l e}}{\bf{\tilde{u}}_{\mathrm{spheric}}\mathrm{\basi}_{\mathrm{\tilde{l}}}}.$$</p>
<br><p id='422' data-category='paragraph' style='font-size:16px'>with:</p>
<br><p id='423' data-category='equation'>$$h{\binom{\alpha}{\alpha}}=h_{1}{\frac{\displaystyle r}{R}}+h_{0}\Biggl(1-{\frac{\displaystyle r}{R}}\Biggr)$$</p>
<p id='424' data-category='paragraph' style='font-size:16px'>Radially we want the constant size h0 but tangentially the size varies between h0 at center and h1 on the<br>boundary of the sphere.</p>
<br><p id='425' data-category='paragraph' style='font-size:16px'>The mesher input metric map is only given at the boundary nodes of the external sphere and at the center<br>node. The mesher will do the interpolation in-between.</p>
<figure id='426'><img alt="" data-coord="top-left:(315,587); bottom-right:(927,1057)" /></figure>
<table id='427' style='font-size:14px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>37</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 38</div>
<figure id='428'><img alt="" data-coord="top-left:(316,110); bottom-right:(928,728)" /></figure>
<br><caption id='429' style='font-size:14px'>Figure 23 – An anisotropic sphere (mesh cut).</caption>
<p id='430' data-category='paragraph' style='font-size:20px'>Background meshes can also be used with the 3-D anisotropic mesher in the same way as the isotropic<br>counter-part (see Example 9). Recall that the metric matrix at each node of the background mesh must be valid<br>(three strictly positive eigen-values).</p>
<table id='431' style='font-size:16px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>38</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 39</div>
<h1 id='432' style='font-size:20px'>CM2 TetraMesh® Iso</h1>
<br><h1 id='433' style='font-size:16px'>Version 5.6</h1>
<h1 id='434' style='font-size:18px'>mesh gallery</h1>
<p id='435' data-category='paragraph' style='font-size:14px'>Revision February 2025.<br>https://www.computing-objects.com<br>© Computing Objects SARL - 25 rue du Maréchal Foch, 78000 Versailles, France.</p>
</div>
<div class="page">
<div class="page-header">Page 40</div>
<figure id='436'><img style='font-size:16px' alt="Figure 1 – Block-stop." data-coord="top-left:(390,406); bottom-right:(858,1005)" /></figure>
<figure id='437'><img style='font-size:14px' alt="Nodes : 270
Tets : 883
Missing faces : 0
Subdomains : 1
Volume : 9.277810E-01
Qmin : 3.409671E-01 (max-min: 5.641645E-01)
Steiner nodes : 0
Front time : 0.00 s.
Refine time : 0.01 s.
Optim time : 0.00 s.
Total time : 0.01 s. (63071.70 th/s.)" data-coord="top-left:(374,1152); bottom-right:(916,1375)" /></figure>
<footer id='438' style='font-size:20px'>The output information given here are only indicative. All runs were done with x64 CM2 libs (Visual Studio 2022 MD build)<br>on Windows 8.1 x64 with Intel Xeon E3-1270 V2 3.5 GHz (4 cores with hyper-threading, turbo boost disabled).</footer>
<table id='439' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>40</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 41</div>
<figure id='440'><img alt="" data-coord="top-left:(393,410); bottom-right:(846,965)" /></figure>
<br><caption id='441' style='font-size:16px'>Figure 2 – Hammer.</caption>
<figure id='442'><img style='font-size:14px' alt="odes : 3027
Tets : 12031
Missing faces : 0
Subdomains : 1
Volume : 2.019083E+11
Qmin : 3.017365E-02 (max-min: 3.031752E-02)
Steiner nodes : 0
Front time : 0.07 s.
Refine time : 0.08 s.
Optim time : 0.01 s.
Total time : 0.16 s. (75193.71 th/s.)" data-coord="top-left:(377,1176); bottom-right:(914,1373)" /></figure>
<table id='443' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>41</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 42</div>
<figure id='444'><img style='font-size:16px' alt="Figure 3 – Driving Rod." data-coord="top-left:(258,402); bottom-right:(975,991)" /></figure>
<figure id='445'><img style='font-size:14px' alt="Nodes : 1844
Tets : 5937
Missing faces : 0
Subdomains : 1
Volume : 9.848692E-01
Qmin : 2.677825E-01 (max-min: 6.300594E-01)
Steiner nodes : 0
Front time : 0.04 s.
Refine time : 0.03 s.
Optim time : 0.02 s.
Total time : 0.09 s. (62494.88 th/s.)" data-coord="top-left:(376,1171); bottom-right:(916,1372)" /></figure>
<table id='446' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>42</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 43</div>
<figure id='447'><img alt="" data-coord="top-left:(280,403); bottom-right:(954,973)" /></figure>
<br><p id='448' data-category='paragraph' style='font-size:16px'>Figure 4 – Blade.</p>
<figure id='449'><img style='font-size:14px' alt="Nodes : 1631
Tets : 5542
Missing faces : 0
Subdomains : 1
Volume : 1.149084E-01
Qmin : 1.701167E-01 (max-min: 2.183494E-01)
Steiner nodes : 0
Front time : 0.04 s.
Refine time : 0.03 s.
Optim time : 0.01 s.
Total time : 0.08 s. (70151.90 th/s.)" data-coord="top-left:(374,1163); bottom-right:(915,1378)" /></figure>
<table id='450' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>43</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 44</div>
<figure id='451'><img alt="" data-coord="top-left:(398,405); bottom-right:(849,966)" /></figure>
<br><caption id='452' style='font-size:16px'>Figure 5 – Rim.</caption>
<figure id='453'><img style='font-size:14px' alt="Nodes : 63984
Tets : 238849
Missing faces : 0
Subdomains : 1
Volume : 6.174414E+06
Qmin : 4.427687E-02 (max-min: 2.414112E-01)
Steiner nodes : 2
Front time : 2.55 s.
Refine time : 1.14 s.
Optim time : 0.78 s.
Total time : 4.52 s. (52819.33 th/s.)" data-coord="top-left:(381,1177); bottom-right:(907,1369)" /></figure>
<table id='454' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>44</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 45</div>
<figure id='455'><img alt="" data-coord="top-left:(284,409); bottom-right:(946,956)" /></figure>
<br><caption id='456' style='font-size:16px'>Figure 6 – Crank.</caption>
<figure id='457'><img style='font-size:14px' alt="Nodes : 50260
Tets : 253949
Missing faces : 0
Subdomains : 1
Volume : 1.170195E+05
Qmin : 3.187160E-01 (max-min: 4.462804E-01)
Steiner nodes : 0
Front time : 0.65 s.
Refine time : 2.04 s.
Optim time : 1.34 s.
Total time : 4.05 s. (62734.43 th/s.)" data-coord="top-left:(374,1165); bottom-right:(918,1377)" /></figure>
<table id='458' style='font-size:20px'><thead></thead><tbody><tr><td>© Computing Objects /version 5.6 rev. February 2025</td><td>CM2 TetraMesh® Iso/Aniso - tutorials</td><td>45</td></tr></tbody></table>
</div>
<div class="page">
<div class="page-header">Page 46</div>
<p id='459' data-category='paragraph' style='font-size:14px'>https://www.computing-objects.com</p>
<br><p id='460' data-category='paragraph' style='font-size:14px'>© Computing Objects SARL - 25 rue du Maréchal Foch, 78000 Versailles, France.</p>
<br><p id='461' data-category='paragraph' style='font-size:14px'>Limited Liability Company with a capital of 100 000 €.<br>Registered at Versailles RCS under SIRET number 422 791 038 00033.<br>EU VAT registration FR59422791038.</p>
</div>

</body>
</html>
